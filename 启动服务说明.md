# 协和医院SCI期刊分析系统 - 启动服务说明

## 🚀 快速启动

### 方式一：一键启动（推荐）
```bash
npm start
```
或者
```bash
./start.sh
```

### 方式二：使用Node.js启动器
```bash
node start-all.js
```

### 方式三：手动启动各服务
```bash
# 启动MySQL
brew services start mysql

# 初始化数据库
./scripts/init-db.sh

# 启动后端（终端1）
cd backend && npm start

# 启动前端（终端2）
cd frontend && npm start
```

## 📋 系统要求

- **Node.js**: >= 16.0.0
- **MySQL**: >= 8.0
- **操作系统**: macOS/Linux
- **浏览器**: Chrome, Firefox, Safari (最新版本)

## 🔧 首次安装

1. **克隆项目**
```bash
git clone <repository-url>
cd hospital-journal-system
```

2. **安装依赖**
```bash
npm install
npm run setup
```

3. **启动系统**
```bash
npm start
```

## 📊 服务地址

启动成功后，可以通过以下地址访问：

- **前端界面**: http://localhost:3000
- **后端API**: http://localhost:3002
- **健康检查**: http://localhost:3002/health
- **数据库**: MySQL (localhost:3306)

## 👤 默认账户

- **用户名**: admin
- **密码**: admin123

## 🛠️ 常用命令

```bash
# 启动所有服务
npm start

# 停止所有服务
npm run stop

# 重新安装依赖
npm run setup

# 清理并重新安装
npm run clean && npm run setup

# 运行测试
npm test

# 构建前端
npm run build

# 部署到生产环境
npm run deploy
```

## 🔍 故障排除

### 1. 端口被占用
```bash
# 清理端口
lsof -ti:3000 | xargs kill -9  # 前端端口
lsof -ti:3002 | xargs kill -9  # 后端端口
```

### 2. MySQL连接失败
```bash
# 启动MySQL
brew services start mysql

# 检查MySQL状态
brew services list | grep mysql

# 重置MySQL密码（如果需要）
mysql -u root -p
```

### 3. 数据库初始化失败
```bash
# 手动初始化数据库
./scripts/init-db.sh

# 或者手动执行
mysql -u root -e "CREATE DATABASE IF NOT EXISTS hospital_journal CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
cd backend && npx sequelize-cli db:migrate && npx sequelize-cli db:seed:all
```

### 4. 依赖安装失败
```bash
# 清理npm缓存
npm cache clean --force

# 重新安装
rm -rf node_modules package-lock.json
npm install
```

### 5. 文献导入时自动退出登录
这个问题已经修复，如果仍然遇到：
1. 检查浏览器控制台是否有错误
2. 确认token是否正确存储在localStorage中
3. 检查网络请求是否携带Authorization头

## 📝 开发模式

### 后端开发
```bash
cd backend
npm run dev  # 使用nodemon自动重启
```

### 前端开发
```bash
cd frontend
npm start    # 热重载开发模式
```

### 数据库操作
```bash
cd backend

# 创建新迁移
npx sequelize-cli migration:generate --name migration-name

# 运行迁移
npx sequelize-cli db:migrate

# 回滚迁移
npx sequelize-cli db:migrate:undo

# 创建种子文件
npx sequelize-cli seed:generate --name seed-name

# 运行种子
npx sequelize-cli db:seed:all
```

## 🔒 安全注意事项

1. **生产环境部署前**：
   - 修改默认管理员密码
   - 更新JWT密钥
   - 配置HTTPS
   - 设置防火墙规则

2. **数据库安全**：
   - 设置MySQL root密码
   - 创建专用数据库用户
   - 限制数据库访问权限

3. **文件上传安全**：
   - 限制文件类型和大小
   - 扫描上传文件
   - 设置上传目录权限

## 📞 技术支持

如遇到问题，请联系：
- 系统管理员
- 开发团队
- 或查看项目文档

---

**版本**: v2.0 - 协和医院专版  
**更新时间**: 2025年7月31日